{% extends 'layout/base_layout.html' %}

{% block title %} Tour List {% endblock %}

{% block style %}
    <style>
        
      body {
        background-image: linear-gradient(to right top, #111111, #121019, #111020, #0f0f27, #0a0f2e);
        height: 100vh;
      }

      .container{
        padding-top: 80px;
      }

      #create-btn{
        padding: 5px 40px;
        background-color: #1dc9b7; 
        border-radius: 50px; 
        border: none;
        opacity: 0.9;
        transition: all 0.5s ease-in-out;
      }

      #create-btn:hover{
        opacity: 1;
        color: #111020;
      }

      #table{
        background-color:rgba(255, 255, 255, 0.1);
      }

      #modalDel{
        border-radius: 15px;
        background-color: rgba(10, 12, 51, 0.7);
      }

      .modalBtn{
        border-radius: 20px;
        padding: 5px 20px;
      }

      .pagination .page-item .page-link{
        background: transparent;
        border: none;
        backdrop-filter: blur(10px);
        box-shadow: 0px 0px 1px #fff;
        color: #fff;
        transition: all 0.5s ease-in-out;
      }
      .pagination .page-item .page-link:hover{
          background: #fff;
          font-weight: 400;
          color: #169de7;
      }

      #modalInp{
        background: transparent;
        border: 1px solid #4d4c4c;
        color: #fff;
      }

      #modalInp::placeholder{
        color: #ccc;
      }

      @media screen and (min-width:768px){
      .listBtn{
        padding: 4px 20px;
      }
      }

    </style>
{% endblock %} 

{% block content %}
    {% include 'partials/navbar.html' %}
    <div class="container">
      <div class="row">
        <div class="col">
          {% include 'partials/alert.html' %}
        </div>
      </div>
        <div class="row">
            <div class="col-12 my-3 mx-auto">
                <h1 class="text-center text-light">Tour List</h1>
                <hr class="bg-dark"> 
              </div>
        </div>
         
        <div class="row mb-3">
            <div class="col-5 ">
                <a href="{% url 'create' %}" class="btn btn-primary" id="create-btn">Add tour</a>
            </div>
            <div class="col-7">
                <form class="form-inline" method="get" style="display: flex;justify-content:end;">
                    <input
                        type="text"
                        class="form-control form-control-sm col-6 col-sm-7 col-md-6"
                        placeholder="Enter the place name"
                        name="term"
                    />
                    {% if is_clicked_search_btn %}
                    <button type="submit" class="btn btn-danger btn-sm ml-2 " style="border-radius: 15px;">Reset</button>
                    {% else %}
                    <button type="submit" class="btn btn-success btn-sm ml-2 " style="border-radius: 15px;">Search</button>
                    {% endif %}
                  </form>
            </div>
        </div>
      <div class="row">
        <div class="col-12 mx-auto">
          <div class="table-responsive">
            <table class="table table-hover table-bordered " id="table">
              <thead>
                <tr class="text-center text-info h4">
                  <th class="align-middle">Place Name</th>
                  <th colspan="3" class="align-middle">itinerary</th>
                  <th class="align-middle" colspan="3">Actions</th>
                </tr>
              </thead>
              <tbody>

                {% if tour_data %}
                  {% for data in tour_data %}
                <tr class="text-center text-white">
                  <td class="h6">{{data.place_name}}</td>
                <!------------------------------itinerary action buttons-------------------------------------------->

                  <td class="align-middle"><a class="btn btn-outline-success btn-sm listBtn " href="{% url 'add_itinerary' data.id %}"><i class="fa fa-plus fa-lg"></i></a></td>
                  <td class="align-middle"><a class="btn btn-outline-info btn-sm listBtn " href="{% url 'edit_itinerary' data.id %}"><i class="fa fa-pencil-square fa-lg"></i></a></td>
                  <td class="align-middle"><a class="btn btn-outline-danger btn-sm listBtn " href="#itineraryModal{{data.id}}" data-toggle="modal"><i class="fa fa-minus fa-lg"></i></a></td>
                <!------------------------------Tour action buttons-------------------------------------------->
                
                  <td class="align-middle"><a class="btn btn-outline-primary btn-sm listBtn" href="{% url 'get_tour_detail_view' data.id %}"><i class="fa fa-eye fa-lg"></i></a></td>
                  <td class="align-middle"><a class="btn btn-outline-warning btn-sm listBtn" href="{% url 'edit_tour_details' data.id %}"><i class="fa fa-pencil-square-o fa-lg"></i></a></td>
                  <td class="align-middle"><a class="btn btn-outline-danger btn-sm listBtn" href="#deleteModal{{data.id}}" data-toggle="modal"><i class="fa fa-trash fa-lg"></i></a></td>
                </tr>
                <!------------------------------Tour Delete Modal-------------------------------------------->
                <div class="modal fade" id="deleteModal{{data.id}}">
                  <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content" id="modalDel">
                      <div class="modal-header">
                        <h4 class="modal-title text-danger">Are you sure want to delete?</h4>
                        <button type="button" class="close text-white" data-dismiss="modal">&times;</button>
                      </div>
                      <form action="{% url 'delete_tour_details' data.id %}" method="get">
                        <div class="modal-body text-center mb-4">
                          <h4 class="my-4 text-white">{{data.place_name}}</h4>
                          <button class="btn btn-outline-success mr-4 modalBtn">Confirm</button>
                          <button class="btn btn-outline-danger modalBtn" >Cancel</button>
                        </div>
                      </form>
                      </div>
                  </div>
                </div>
                <!------------------------------itinerary Delete Modal-------------------------------------------->

                <div class="modal fade" id="itineraryModal{{data.id}}">
                  <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content" id="modalDel">
                      <div class="modal-header">
                        <h4 class="modal-title text-danger">Are you sure want to delete?</h4>
                        <button type="button" class="close text-white" data-dismiss="modal">&times;</button>
                      </div>
                      <div class="modal-body text-center mb-4">
                        
                        <form action="{% url 'delete_itinerary' data.id %}" method="post">
                          {% csrf_token %}
                          <input id="modalInp" type="number" class="form-control form-control-sm col-8 mx-auto d-block mb-4" name="day" min="1" max="{{data.total_trip_days}}" placeholder="Enter the itinerary day you want to delete.">
                          <button class="btn btn-outline-success btn-sm mr-4 modalBtn">Confirm</button>
                          <a href="{% url 'get_tour_list' %}" class="btn btn-outline-danger btn-sm modalBtn" >Cancel</a>
                        </form>
                        
                      </div>
                      </div>
                  </div>
                </div>
                {% endfor %}
                {% else %}
                <tr class="text-center text-white">
                  <td colspan="4" class="h5 text-center text-danger">No data found</td>
                </tr>
                {% endif %}
              </tbody>
            </table>
          </div>
          
        </div>
      </div>
      <!-------------------------Pagination------------------------------>
      <div class="row">
        <div class="col">
          <nav aria-label="Page navigation example" >
            <ul class="pagination pagination-sm justify-content-center">
            {% if tour_data.has_previous %}
            
            <li class="page-item"><a href="?page=1" class="page-link">&laquo; first</a></li>
            <li class="page-item"><a href="?page={{ tour_data.previous_page_number }}" class="page-link" aria-label="previous">&laquo; previous</a></li>
            {% endif %}
            
            {% for page_number in tour_data.paginator.get_elided_page_range %}
            {% if tour_data.number == page_number %}
            <li class="page-item"><span class="page-link">{{ page_number }}</span></li>
            {% else %}
            <li class="page-item"><a href="?page={{ page_number }}" class="page-link">{{ page_number }}</a></li>
            {% endif %}
            {% endfor %}
            
            {% if tour_data.has_next %}
            <li class="page-item"><a href="?page={{ tour_data.next_page_number }}" class="page-link">next &raquo;</a></li>
            <li class="page-item"><a href="?page={{ tour_data.paginator.num_pages }}" class="page-link">last &raquo;</a></li>
            {% endif %}
            </ul>
            </nav>            
        </div>
      </div>
    </div>
{% endblock %} 
